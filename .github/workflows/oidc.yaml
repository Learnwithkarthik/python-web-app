name: Debug GitHub OIDC Token

on:
  workflow_dispatch:

permissions:
  id-token: write
  contents: read

jobs:
  debug:
    runs-on: ubuntu-latest

    steps:
      - name: Print OIDC Token (Safe Decode)
        run: |
          echo "Requesting OIDC token..."

          TOKEN=$(curl -s -H "Authorization: Bearer $ACTIONS_ID_TOKEN_REQUEST_TOKEN" \
            "${ACTIONS_ID_TOKEN_REQUEST_URL}&audience=debug" | sed -n 's/.*"value":"\([^"]*\)".*/\1/p')
